default_platform(:ios)

platform :ios do
  desc "Build and upload to TestApp.io"
  lane :beta do
    # Ensure the FASTLANE_SESSION is passed from secrets (GitHub Actions)
    ENV["FASTLANE_SESSION"] = ENV["FASTLANE_SESSION"]

    build_app(
      scheme: "TestCiApp",                   # â† Ø¹Ø¯Ù‘Ù„ Ø­Ø³Ø¨ Ø§Ø³Ù… Ø§Ù„Ù€ Scheme Ø¨ØªØ§Ø¹Ùƒ
      export_method: "development",
      export_options: {
        signingStyle: "automatic"
      },
      xcargs: "-allowProvisioningUpdates"    # â† Ø¹Ø´Ø§Ù† ÙŠØ³Ù…Ø­ Ø¨Ø¥Ù†Ø´Ø§Ø¡ profile ØªÙ„Ù‚Ø§Ø¦ÙŠ
    )

    upload_to_testappio(
      token: "0db11f3c-d0d7-4b1c-8c76-8197063b74a5", # â† ØªÙˆÙƒÙ† TestApp.io Ø¨ØªØ§Ø¹Ùƒ
      release_notes: "Beta build from GitHub Actions ğŸš€"
    )
  end
end

